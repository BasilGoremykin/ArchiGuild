# ADR.001 Определение стратегии консистентности и доступности для системы видеоконференций

* Статус: Принято
* Владелец: vvgoremy10@mts.ru

## Контекст
Для обеспечения надежности и гарантии работы системы конференции, необходимо определить стратегию консистентности данных. Решение должно учитывать использование различных микросервисов и инструментов, находящихся в ландшафте технологического радара МТС.

## Варианты решения
### Вариант 1. AP(Availability, Partition tolerance)
AP-системы обеспечивают высокую доступность и устойчивость к разделению сети. В таких системах приоритет отдается доступности, даже если это может привести к временной несогласованности данных. В AP-системах данные обновляются асинхронно, что позволяет пользователям видеть разные версии данных, но предоставляет высокую доступность и устойчивость к разделению сети.
* **Плюсы**
  * Высокая доступность: AP-системы гарантируют доступ к данным в любое время, даже при сбоях в сети.
  * Устойчивость к разделению сети: AP-системы продолжают функционировать, даже если происходит разделение сети.
* **Минусы**
  * Временная несогласованность данных: Из-за асинхронного обновления данных пользователи могут видеть разные версии данных.
  * Риск потери данных: В некоторых случаях, асинхронное обновление данных может привести к потере некоторых обновлений.

### Вариант 2. CA(Consistency, Availability)
CA-системы обеспечивают согласованность данных в реальном времени и высокую доступность. В таких системах приоритет отдается одновременно и согласованности данных, и доступности, однако они не устойчивы к разделению сети. В CA-системах данные обновляются синхронно, что обеспечивает однородность данных для всех пользователей и высокую доступность, но может вызвать проблемы при разделении сети, так как система не устойчива к таким ситуациям.
* **Плюсы**
  * Согласованность данных в реальном времени: CA-системы обеспечивают однородность данных для всех пользователей.
  * Высокая доступность: CA-системы гарантируют доступ к данным в любое время.
* **Минусы**
  * Неустойчивость к разделению сети: CA-системы могут столкнуться с проблемами при разделении сети, так как они не устойчивы к таким ситуациям.
  * Требования к оборудованию: Для обеспечения согласованности данных и высокой доступности, CA-системы могут потребовать высококачественного оборудования и надежной сетевой инфраструктуры.

### Вариант 3. CP(Consistency, Partition tolerance)
CP-системы обеспечивают согласованность данных в реальном времени и устойчивость к разделению сети. В таких системах приоритет отдается согласованности данных, даже если это может привести к временному снижению доступности. В CP-системах данные обновляются синхронно, что обеспечивает однородность данных для всех пользователей, но может привести к снижению доступности при разделении сети.
* **Плюсы**
  * Согласованность данных в реальном времени: CP-системы обеспечивают однородность данных для всех пользователей.
  * Устойчивость к разделению сети: CP-системы продолжают функционировать, даже если происходит разделение сети.
* **Минусы**
  * Снижение доступности: Приоритет согласованности данных может привести к временному снижению доступности.
  * Более сложная инфраструктура: CP-системы могут потребовать сложных алгоритмов для обеспечения согласованности данных.

## Решение
Мы выбираем свойства CAP "CA" (Consistency, Availability), так как для нашей системы видеоконференций важнее обеспечить согласованность данных в реальном времени и высокую доступность. Учитывая отсутствие требований к масштабированию и использование ACID, это решение обеспечивает достаточную производительность и надежность.

Также, для более детального уточнения свойств нашей системы, мы выбираем PACELC с упором на согласованность данных (C) в условиях нормальной работы (P) и согласованность данных (C) в условиях сетевых разделений (E).

## Последствия 
Выбор CA повлечет за собой следующие последствия:
* **Положительные**
  * Строгая консистентность данных: все операции с данными на конференциях, пользователях и оплате будут согласованы
  * Простота разработки и обработки ошибок: упрощает разработку и отладку приложения в случаях, когда требуется согласованность данных
* **Отрицательные**
  * Меньшая масштабируемость: может стать проблемой при увеличении нагрузки на систему
  * Возможная необходимость оптимизации производительности в будущем, если нагрузка на систему значительно возрастет